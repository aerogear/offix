<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.fd17476c3">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Offix Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Offix Blog Atom Feed"><title data-react-helmet="true">Client Side Conflict Resolution | Offix</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="0.14.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-0.14.0"><meta data-react-helmet="true" property="og:title" content="Client Side Conflict Resolution | Offix"><meta data-react-helmet="true" name="description" content="When performing data synchronization between multiple clients it is common for remote devices to become offline for a certain amount of time. As a result of being offline, data that is modified by a client can become outdated with the server. Further operations on that record can cause a conflict (often called a collision). For more information about offline workflows, please see Offline Support"><meta data-react-helmet="true" property="og:description" content="When performing data synchronization between multiple clients it is common for remote devices to become offline for a certain amount of time. As a result of being offline, data that is modified by a client can become outdated with the server. Further operations on that record can cause a conflict (often called a collision). For more information about offline workflows, please see Offline Support"><meta data-react-helmet="true" property="og:url" content="https://offix.dev/docs/0.14.0/conflict-client"><link data-react-helmet="true" rel="shortcut icon" href="/img/offix-logo.png"><link data-react-helmet="true" rel="alternate" href="https://offix.dev/docs/0.14.0/conflict-client" hreflang="x-default"><link data-react-helmet="true" rel="canonical" href="https://offix.dev/docs/0.14.0/conflict-client"><link rel="stylesheet" href="/assets/css/styles.053ba0cf.css">
<link rel="preload" href="/assets/js/styles.df1c69a3.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.72d6d366.js" as="script">
<link rel="preload" href="/assets/js/main.4bcbd855.js" as="script">
<link rel="preload" href="/assets/js/1.0e5991f8.js" as="script">
<link rel="preload" href="/assets/js/2.ed458a7f.js" as="script">
<link rel="preload" href="/assets/js/68.3c3873a8.js" as="script">
<link rel="preload" href="/assets/js/69.4e129213.js" as="script">
<link rel="preload" href="/assets/js/01aeec71.bee65b7c.js" as="script">
<link rel="preload" href="/assets/js/17896441.fb5976c2.js" as="script">
<link rel="preload" href="/assets/js/bfd07d86.439c0a1e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_1oUP">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/offix-logo.png" alt="Offix Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/offix-logo.png" alt="Offix Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Offix</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started">0.15.0</a></li><li><a class="dropdown__link" href="/docs/0.14.0/getting-started">0.14.0</a></li><li><a class="dropdown__link" href="/docs/0.13.0/getting-started">0.13.0</a></li><li><a class="dropdown__link" href="/docs/next/getting-started">Master/Unreleased</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/versions">v0.15.0</a><a href="https://github.com/aerogear/offix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/offix-logo.png" alt="Offix Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/offix-logo.png" alt="Offix Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Offix</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" role="button" href="/docs/getting-started">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">0.15.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.14.0/getting-started">0.14.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.13.0/getting-started">0.13.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/getting-started">Master/Unreleased</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/versions">v0.15.0</a></li><li class="menu__list-item"><a href="https://github.com/aerogear/offix" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/client-configuration">Client Configuration</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Offix Client</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.14.0/offline-client">Offline Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.14.0/offix-cache">Client Cache</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/0.14.0/conflict-client">Conflicts Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.14.0/conflict-server">Conflict Server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Platforms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/react">React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/react-native">React Native</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/angular">Angular</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/ionic">Ionic and Cordova</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/android">Android</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/cookbooks">Offline Cookbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/offix-scheduler-introduction">Offix Scheduler</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Releases</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/0.14.0/release-notes">Release notes</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Offix <strong>0.14.0</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/conflict-client">latest version</a></strong> (0.15.0).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: 0.14.0</span></div><header><h1 class="docTitle_3a4h">Client Side Conflict Resolution</h1></header><div class="markdown"><p>When performing data synchronization between multiple clients it is common for remote devices to become offline for a certain amount of time. As a result of being offline, data that is modified by a client can become outdated with the server. Further operations on that record can cause a conflict (often called a collision). For more information about offline workflows, please see <a href="/docs/0.14.0/offline-client">Offline Support</a></p><p>Offix provides a way to manage and resolve these conflicts for any GraphQL type.
Conflict implementation will require additional elements in your application in order to work:</p><ul><li>Mutation <code>returnType</code> added on context to any mutation</li><li>Additional metadata inside types (for example version field) depending on conflict implementation</li></ul><p>Conflict mechanism is divided between:</p><ul><li>Conflict detection
Developers can detect conflicts on resolver level</li><li>Conflict resolution
Conflicts are sent back to client and resolved by resending data back to server.</li></ul><p>Offix allows developers to detect and resolve conflict without user interactions.
By default when no changes were made on the same fields, the implementation will try to resend the modified payload back to the server. When changes on the server and the client cover the same fields one of the specified conflict resolution strategies can be used. The default strategy will apply client changes on top of the server side.
Developers can modify strategies to suit their needs.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="working-with-conflict-resolution-on-client"></a>Working with Conflict Resolution on Client<a class="hash-link" href="#working-with-conflict-resolution-on-client" title="Direct link to heading">#</a></h2><p>To enable conflict resolution we fist need to configure our server side resolvers to perform conflict detection. Detection can rely on many different implementations and return the conflict error back to the client. For more information about how to do this, please see <a href="/docs/0.14.0/conflict-server">Server Side Conflict Resolution</a></p><p>The client will then automatically resolve them based on the current strategy and notify listeners if the developer supplied any.</p><p>Conflict resolution will work out of the box with the recommended defaults and does not require any specific handling on the client.</p><blockquote><p>For advanced use cases developers may customize their conflict implementation by supplying a custom <code>conflictProvider</code> in config. See Conflict Resolution Strategies below.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="default-conflict-implementation"></a>Default Conflict Implementation<a class="hash-link" href="#default-conflict-implementation" title="Direct link to heading">#</a></h2><p>By default, conflict resolution is configured to rely on a <code>version</code> field on each GraphQL type.
Version field will also need to be saved to the database in order to detect changes on the server</p><p>For example:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type </span><span class="token maybe-class-name">User</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">ID</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  version</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">String</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">String</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The version field is controlled on the server and will map the last version that was sent from the server. All operations on the version field happen automatically, however, users need to make sure that the version field is always passed to server for mutations that supports conflict resolution:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type </span><span class="token maybe-class-name">Mutation</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">updateUser</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">id</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">ID</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> version</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">String</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">User</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Alternatively developers can create input elements that can be reused in every mutation and support conflict resolution.</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">type </span><span class="token maybe-class-name">Mutation</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">updateUser</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">user</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">UserInput</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">User</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-conflict-implementation-by-extening-objectstate"></a>Custom Conflict implementation by extening ObjectState<a class="hash-link" href="#custom-conflict-implementation-by-extening-objectstate" title="Direct link to heading">#</a></h3><p>Offix enables flexibility on how conflicts are detected and resolved.
In many cases developers may need different ways of detecting conflits than relying on version field
stored in database. For example if database already have <code>changedAt</code> field that is being supported by trigger it can be used as custom conflict implemementation.</p><p>Under the hood conflicts implementations are extending an <code>ObjectState</code> interface.
This interface exist on both client and server and provides functions that help with detection and resolution of conflicts.</p><p>The default implementation is <code>VersionedObjectState</code>. This means Offix expects all data which could be conflicted to have a version field. If this is not the case, developers can also provide custom state which Offix will then use for conflict resolution. To do this, Offix expects certain functions to be available under the <code>conflictProvider</code> option in config. These functions and their signatures are:</p><p><code>assignServerState(client, server)</code> - assigns the server state to the client state to reduce the chance of a second conflict.</p><p><code>hasConlict(client, server)</code> - detects whether or not both sets of data are conflicted.</p><p><code>getStateFields()</code> - returns an array of fields that should not be taken into account for conflict purposes.</p><p><code>currentState(objectWithState)</code> - returns the current state of the object.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conflict-resolution-strategies"></a>Conflict Resolution Strategies<a class="hash-link" href="#conflict-resolution-strategies" title="Direct link to heading">#</a></h2><p>Offix allows developers to define custom conflict resolution strategies. You can provide custom conflict resolution strategies to the client in the config by using the provided <code>ConflictResolutionStrategies</code> type. By default developers do not need to pass any strategy as <code>UseClient</code> is the default. Custom strategies can be used also to provide different resolution strategy for certain operations:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> customStrategy </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(111, 66, 193)">resolve</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">base</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> server</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> client</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> operationName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> resolvedData</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operationName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> </span><span class="token string">&quot;updateUser&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">delete</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">socialKey</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        resolvedData </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">Object</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assign</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#e3116c">break</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword" style="color:#e3116c">case</span><span class="token plain"> </span><span class="token string">&quot;updateRole&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">role</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;none&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        resolvedData </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">Object</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assign</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#e3116c">break</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword module" style="color:#e3116c">default</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        resolvedData </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">Object</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assign</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> resolvedData</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This custom strategy provides two custom strategies to be used when a conflict occurs. They are based on the name of the operation to give developers granular control. To use this custom strategy pass it as an argument to conflictStrategy in your config object:</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> config </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  conflictStrategy</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> customStrategy</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="listening-to-conflicts"></a>Listening to Conflicts<a class="hash-link" href="#listening-to-conflicts" title="Direct link to heading">#</a></h2><p>Offix allows developers to receive information about the data conflict that occurred between the client and the server. The client can be notified in one of two scenarios.</p><p>When a conflict occurs Offix will attempt to do a field level resolution of data - meaning it will check all fields of your type to see if both the client or server has changed them.</p><p>If both client and server have changed any of the same fields then the <code>conflictOccurred</code> method of your <code>ConflictListener</code> will be triggered.</p><p>If the client and server have not changed any of the same fields and the data can be easily merged then the <code>mergeOccurred</code> method of your <code>ConflictListener</code> will be triggered.</p><p>Developers can supply their own <code>conflictListener</code> implementation</p><div class="mdxCodeBlock_3lFL"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">ConflictLogger</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">ConflictListener</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token function" style="color:rgb(111, 66, 193)">conflictOccurred</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operationName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> resolvedData</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;Conflict occurred with the following:&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">data: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">resolvedData</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, server: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">server</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, client: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">client</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, operation:  </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">operationName</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token function" style="color:rgb(111, 66, 193)">mergeOccurred</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">operationName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> resolvedData</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> server</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;Merge occurred with the following:&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">data: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">resolvedData</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, server: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">server</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, client: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">client</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">, operation:  </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">JSON</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation function" style="color:rgb(111, 66, 193)">stringify</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation">operationName</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> config </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  conflictListener</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">new</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">ConflictLogger</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/aerogear/offix/edit/master/website/versioned_docs/version-0.14.0/ref-conflict-client.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/0.14.0/offix-cache"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Offix Cache</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/0.14.0/conflict-server"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Server Side Conflict Resolution »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#working-with-conflict-resolution-on-client" class="table-of-contents__link">Working with Conflict Resolution on Client</a></li><li><a href="#default-conflict-implementation" class="table-of-contents__link">Default Conflict Implementation</a><ul><li><a href="#custom-conflict-implementation-by-extening-objectstate" class="table-of-contents__link">Custom Conflict implementation by extening ObjectState</a></li></ul></li><li><a href="#conflict-resolution-strategies" class="table-of-contents__link">Conflict Resolution Strategies</a></li><li><a href="#listening-to-conflicts" class="table-of-contents__link">Listening to Conflicts</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/offline-client">Offix Client</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/react">Platforms</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cookbooks">Advanced Topics</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/release-notes">Releases</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/aerogear/offix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://discordapp.com/invite/mJ7j84m" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://aerogear.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/aerogear.png" alt="AeroGear Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/aerogear.png" alt="AeroGear Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 AeroGear</div></div></div></footer></div>
<script src="/assets/js/styles.df1c69a3.js"></script>
<script src="/assets/js/runtime~main.72d6d366.js"></script>
<script src="/assets/js/main.4bcbd855.js"></script>
<script src="/assets/js/1.0e5991f8.js"></script>
<script src="/assets/js/2.ed458a7f.js"></script>
<script src="/assets/js/68.3c3873a8.js"></script>
<script src="/assets/js/69.4e129213.js"></script>
<script src="/assets/js/01aeec71.bee65b7c.js"></script>
<script src="/assets/js/17896441.fb5976c2.js"></script>
<script src="/assets/js/bfd07d86.439c0a1e.js"></script>
</body>
</html>